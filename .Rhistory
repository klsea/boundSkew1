d2 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew'))
d3 <- spread(d2[,c(1,2,4)], 'deg_skew', 'accept')
b1_follow <- pairedttable(d3, colnames(d3[2:5]))
View(b1_follow)
install.packages(rlist)
install.packages('rlist')
library(rlist)
#write.csv(b1_follow, here::here('output', 'b1_follow.csv'))
list.save(b1_follow, here::here('ouptut', 'b1_follow.rds'))
#write.csv(b1_follow, here::here('output', 'b1_follow.csv'))
list.save(b1_follow, here::here('ouptut', 'b1_follow.rds'))
#write.csv(b1_follow, here::here('output', 'b1_follow.csv'))
list.save(b1_follow, here::here('ouptut', 'b1_follow.rdata'))
#write.csv(b1_follow, here::here('output', 'b1_follow.csv'))
list.save(b1_follow, here::here('output', 'b1_follow.rds'))
source('~/github/boundSkew1/03_model_skew.R', echo=TRUE)
# load required packages
library(here)
library(lme4)
library(gdata)
library(tidyr)
library(rlist)
# load source functions
source(here::here('scr', 'isolate_skew.R'))
source(here::here('scr', 'clean_skew.R'))
source(here::here('scr', 'SummarySE.R'))
source(here::here('scr', 'pairedttable.R'))
# load data
dt <- read.csv(here::here("data", "bound_skew1_data.csv"))
# separate skew
d0 <- isolate_skew(dt,c(1,2),10:69)
d1 <- clean_skew(d0)
# recode response to acceptance
d1$accept <- d1$response - 1
# reorder deg_skew factor
d1$deg_skew <- factor(d1$deg_skew, levels = c('Symmetric', 'Weak', 'Moderate', 'Strong'))
# reorder valence factor
d1$valence <- factor(d1$valence, levels = c('neutral', 'gain', 'loss'))
# make magnitude a factor
d1$magnitude <- factor(d1$magnitude, levels = c('0', '0.5', '5'))
View(pairedttable)
View(pairedttable)
# scale and center age
d1$Age <- scale(d1$Age)
# make interaction term
d1$magval <- interaction(d1$valence, d1$magnitude)
d1$magval <- drop.levels(d1$magval)
# make interaction term
d1$magval <- interaction(d1$valence, d1$magnitude)
d1$magval <- drop.levels(d1$magval)
d1$magval <- factor(d1$magval, levels = c('neutral.0', 'loss.5', 'loss.0.5', 'gain.0.5', 'gain.5'))
# baseline - only degree of skew
b1 <- glmer(accept ~ deg_skew + (1 + Age | ID), data = d1, family = binomial(link = logit), nAGQ = 1,
control=glmerControl(optimizer='bobyqa'))
summary(b1, correlation = FALSE)
## boundary fit - remove age from random effects
b1.1 <- glmer(accept ~ deg_skew + (1 | ID), data = d1, family = binomial(link = logit), nAGQ = 1,
control=glmerControl(optimizer='bobyqa'))
summary(b1.1, correlation = FALSE)
saveRDS(b1.1, here::here('output', 'baseline.RDS'))
##follow-up t-tests
d2 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew'))
d3 <- spread(d2[,c(1,2,4)], 'deg_skew', 'accept')
b1_follow <- pairedttable(d3, colnames(d3[2:5]))
list.save(b1_follow, here::here('output', 'b1_follow.rds'))
rm(d2,d3, b1_follow)
# model 1 - add valence
m1 <- glmer(accept ~ deg_skew * valence + (1 | ID), data = d1, family = binomial(link = logit), nAGQ = 1,
control=glmerControl(optimizer='bobyqa'))
summary(m1, correlation = FALSE)
saveRDS(m1, here::here('output', 'm1.RDS'))
## compare model 1 and model 2
anova(b1.1,m1)
## follow-up t-tests
d4 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'valence'))
d4$skew_valence <- interaction(d4$deg_skew, d4$valence)
d5 <- spread(d4[,c(1,9,5)], 'skew_valence', 'accept')
View(d5)
m1_follow_neutral <- pairedttable(d5, colnames(d5[2:5]), 1)
m1_follow_neutral <- pairedttable(d5, colnames(d5[2:5]))
m1_follow_gain <- pairedttable(d5, colnames(d5[6:9]))
m1_follow_loss <- pairedttable(d5, colnames(d5[10:13]))
list.save(m1_follow_neutral, here::here('output', 'm1_follow_neutral.rds'))
list.save(m1_follow_gain, here::here('output', 'm1_follow_gain.rds'))
list.save(m1_follow_loss, here::here('output', 'm1_follow_loss.rds'))
rm(d4, d5, m1_follow_neutral, m1_follow_gain, m1_follow_loss)
source('~/github/boundSkew1/03_model_skew.R', echo=TRUE)
saveRDS(m2, here::here('output', 'm2.RDS'))
source('~/github/boundSkew1/03_model_skew.R', echo=TRUE)
library(here)
library(lme4)
library(gdata)
library(tidyr)
library(rlist)
# load source functions
source(here::here('scr', 'isolate_skew.R'))
source(here::here('scr', 'clean_skew.R'))
source(here::here('scr', 'SummarySE.R'))
source(here::here('scr', 'pairedttable.R'))
# set hard-coded variables
# load data
dt <- read.csv(here::here("data", "bound_skew1_data.csv"))
# separate skew
d0 <- isolate_skew(dt,c(1,2),10:69)
d1 <- clean_skew(d0)
# recode response to acceptance
d1$accept <- d1$response - 1
# reorder deg_skew factor
d1$deg_skew <- factor(d1$deg_skew, levels = c('Symmetric', 'Weak', 'Moderate', 'Strong'))
# reorder valence factor
d1$valence <- factor(d1$valence, levels = c('neutral', 'gain', 'loss'))
# make magnitude a factor
d1$magnitude <- factor(d1$magnitude, levels = c('0', '0.5', '5'))
# scale and center age
d1$Age <- scale(d1$Age)
# make interaction term
d1$magval <- interaction(d1$valence, d1$magnitude)
d1$magval <- drop.levels(d1$magval)
d1$magval <- factor(d1$magval, levels = c('neutral.0', 'loss.5', 'loss.0.5', 'gain.0.5', 'gain.5'))
## Follow-up t-tests
d6 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'magnitude'))
d6$skew_mag <- interaction(d6$deg_skew, d6$magnitude)
d7 <- spread(d6[,c(1,9,5)], 'skew_mag', 'accept')
m2_follow_neutral <- pairedttable(d7, colnames(d7[2:5]))
m2_follow_gain <- pairedttable(d7, colnames(d7[6:9]))
m2_follow_zero <- pairedttable(d7, colnames(d7[2:5]))
m2_follow_small <- pairedttable(d7, colnames(d7[6:9]))
m2_follow_large <- pairedttable(d7, colnames(d7[10:13]))
list.save(m2_follow_zero, here::here('output', 'm2_follow_zero.rds'))
list.save(m2_follow_small, here::here('output', 'm2_follow_smallmag.rds'))
list.save(m2_follow_large, here::here('output', 'm2_follow_largemag.rds'))
rm(d6, d7, m2_follow_zero, m2_follow_small, m2_follow_large)
View(m2_follow_gain)
## Follow-up t-tests
d6 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'magnitude'))
View(d6)
d6$skew_mag <- interaction(d6$deg_skew, d6$magnitude)
d7 <- spread(d6[,c(1,9,5)], 'skew_mag', 'accept')
m2_follow_zero <- pairedttable(d7, colnames(d7[2:5]))
m2_follow_small <- pairedttable(d7, colnames(d7[6:9]))
m2_follow_large <- pairedttable(d7, colnames(d7[10:13]))
source('~/github/boundSkew1/03_model_skew.R', echo=TRUE)
b1_follow <- readRDS("~/github/boundSkew1/output/b1_follow.rds")
b1_follow$tval
m1_follow_loss <- readRDS("~/github/boundSkew1/output/m1_follow_loss.rds")
m1_follow_loss$tval
m2_follow_largemag <- readRDS("~/github/boundSkew1/output/m2_follow_largemag.rds")
m2_follow_largemag$tval
View(pairedttable)
View(pairedttable)
m2_follow_smallmag$tval
m2_follow_smallmag <- readRDS("~/github/boundSkew1/output/m2_follow_smallmag.rds")
m2_follow_smallmag$tval
View(pairedttable)
## Follow-up t-tests
d6 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'magnitude'))
d6$skew_mag <- interaction(d6$deg_skew, d6$magnitude)
d7 <- spread(d6[,c(1,9,5)], 'skew_mag', 'accept')
View(d7)
View(d7)
colMeans(d7)
colMeans(d7, na.rm=T)
m2_follow_zero <- pairedttable(d7, colnames(d7[2:5]))
m2_follow_zero
m2_follow_small <- pairedttable(d7, colnames(d7[6:9]))
m2_follow_zero <- pairedttable(d7[c(1,2:5)], colnames(d7[2:5]))
m2_follow_small <- pairedttable(d7[c(1,6:9)], colnames(d7[6:9]))
m2_follow_small
## Follow-up t-tests
d6 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'magnitude'))
d6$skew_mag <- interaction(d6$deg_skew, d6$magnitude)
d7 <- spread(d6[,c(1,9,5)], 'skew_mag', 'accept')
m2_follow_zero <- pairedttable(d7[c(1,2:5)], colnames(d7[2:5]))
m2_follow_small <- pairedttable(d7[c(1,6:9)], colnames(d7[6:9]))
m2_follow_large <- pairedttable(d7[[c(1,10:13)]], colnames(d7[10:13]))
list.save(m2_follow_zero, here::here('output', 'm2_follow_zero.rds'))
list.save(m2_follow_small, here::here('output', 'm2_follow_smallmag.rds'))
list.save(m2_follow_large, here::here('output', 'm2_follow_largemag.rds'))
rm(d6, d7, m2_follow_zero, m2_follow_small, m2_follow_large)
m1_follow_neutral <- pairedttable(d5[c(1,2:5)], colnames(d5[2:5]))
m1_follow_gain <- pairedttable(d5[c(1,6:9)], colnames(d5[6:9]))
m1_follow_loss <- pairedttable(d5[c(1,10:13)], colnames(d5[10:13]))
list.save(m1_follow_neutral, here::here('output', 'm1_follow_neutral.rds'))
list.save(m1_follow_gain, here::here('output', 'm1_follow_gain.rds'))
list.save(m1_follow_loss, here::here('output', 'm1_follow_loss.rds'))
rm(d4, d5, m1_follow_neutral, m1_follow_gain, m1_follow_loss)
m1_follow_neutral <- pairedttable(d5[c(1,2:5)], colnames(d5[2:5]))
## follow-up t-tests
d4 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'valence'))
d4$skew_valence <- interaction(d4$deg_skew, d4$valence)
d5 <- spread(d4[,c(1,9,5)], 'skew_valence', 'accept')
m1_follow_neutral <- pairedttable(d5[c(1,2:5)], colnames(d5[2:5]))
m1_follow_gain <- pairedttable(d5[c(1,6:9)], colnames(d5[6:9]))
m1_follow_loss <- pairedttable(d5[c(1,10:13)], colnames(d5[10:13]))
list.save(m1_follow_neutral, here::here('output', 'm1_follow_neutral.rds'))
list.save(m1_follow_gain, here::here('output', 'm1_follow_gain.rds'))
list.save(m1_follow_loss, here::here('output', 'm1_follow_loss.rds'))
rm(d4, d5, m1_follow_neutral, m1_follow_gain, m1_follow_loss)
## Follow-up t-tests
d6 <- summarySE(d1, 'accept', groupvars = c('ID', 'deg_skew', 'magnitude'))
d6$skew_mag <- interaction(d6$deg_skew, d6$magnitude)
d7 <- spread(d6[,c(1,9,5)], 'skew_mag', 'accept')
m2_follow_zero <- pairedttable(d7[c(1,2:5)], colnames(d7[2:5]))
m2_follow_small <- pairedttable(d7[c(1,6:9)], colnames(d7[6:9]))
m2_follow_large <- pairedttable(d7[c(1,10:13)], colnames(d7[10:13]))
list.save(m2_follow_zero, here::here('output', 'm2_follow_zero.rds'))
list.save(m2_follow_small, here::here('output', 'm2_follow_smallmag.rds'))
list.save(m2_follow_large, here::here('output', 'm2_follow_largemag.rds'))
rm(d6, d7, m2_follow_zero, m2_follow_small, m2_follow_large)
source('~/github/boundSkew1/03_model_skew.R', echo=TRUE)
m3_follow_loss_5 <- readRDS("~/github/boundSkew1/output/m3_follow_loss_5.rds")
View(m3_follow_loss_5)
# load required packages
library(here)
library(ggplot2)
library(gdata)
# load source functions
source(here('scr', 'isolate_skew.R'))
source(here('scr', 'clean_skew.R'))
source(here('scr', 'SummarySE.R'))
source(here('scr', 'multiplot.R'))
# load data
dt <- read.csv(here("data", "bound_skew1_data.csv"))
# separate skew
d0 <- isolate_skew(dt,c(1,2),10:69)
d1 <- clean_skew(d0)
# recode response to acceptance
d1$accept <- d1$response - 1
# reorder deg_skew factor
d1$deg_skew <- factor(d1$deg_skew, levels = c('Symmetric', 'Weak', 'Moderate', 'Strong'))
# make magnitude a factor
d1$magnitude <- factor(d1$magnitude)
# age effects on acceptance rates
ggplot(d1, aes(Age, accept, colour = deg_skew, fill = deg_skew)) + geom_smooth(method=lm) +
theme(legend.position = 'top') + facet_grid(magnitude ~ valence)
# create summary - main effect of degree of skewness
d2 <- summarySE(data=d1, measurevar = 'accept', groupvars='deg_skew')
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') + expand_limits(y=1) +
guides(fill=FALSE)
# create summary - add interaction with valence of gamble
d3 <- summarySE(data=d1, measurevar = 'accept', groupvars=c('valence','deg_skew'))
p4 <- ggplot(d3, aes(valence, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme(legend.position = 'top')
# create summary - add interaction with magnitude of gamble
d4 <- summarySE(data=d1, measurevar = 'accept', groupvars=c('magnitude','deg_skew'))
p5 <- ggplot(d4, aes(magnitude, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme(legend.position = 'top')
# create summary - 3 way interaction
d5 <- summarySE(data=d1, measurevar = 'accept', groupvars=c('valence', 'magnitude', 'deg_skew'))
ggplot(d5, aes(valence, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme(legend.position = 'top') + facet_wrap(~ magnitude)
# make interaction term
d1$magval <- interaction(d1$valence, d1$magnitude)
d1$magval <- drop.levels(d1$magval)
d1$magval <- factor(d1$magval, levels = c('loss.5', 'loss.0.5', 'neutral.0', 'gain.0.5', 'gain.5'))
levels(d1$magval)[1] <- '-$5.00'
levels(d1$magval)[2] <- '-$0.50'
levels(d1$magval)[3] <- '$0.00'
levels(d1$magval)[4] <- '+$0.50'
levels(d1$magval)[5] <- '+$5.00'
d6 <- summarySE(data=d1, measurevar = 'accept', groupvars=c('magval', 'deg_skew'))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1)
p2
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') + expand_limits(y=1) #+
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') + expand_limits(y=1) + guides(fill=FALSE)
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') + expand_limits(y=1) + guides(fill=FALSE) +
axis.text.x = element_text(angle=90)
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') + expand_limits(y=1) + guides(fill=FALSE) +
axis.text.x = element_text(angle=90)
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') + axis.text.x = element_text(angle=90) +
expand_limits(y=1) + guides(fill=FALSE)
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal(axis.text.x = element_text(angle=90)) + xlab('Degree of Skewness') + ylab('Acceptance Rate') +
expand_limits(y=1) + guides(fill=FALSE)
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') +
expand_limits(y=1) + guides(fill=FALSE) + theme(axis.text.x = element_text(angle=90))
p1
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1) +
theme(axis.text.x = element_text(angle=90))
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1)
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') +
expand_limits(y=1) + guides(fill=FALSE) + theme(axis.text.x=element_blank())
p1
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1) +
theme(legend.position=c(.75, .75))
p2
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1) +
theme(legend.position="top"))#c(.75, .75))
p2
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1) +
theme(legend.position="top")) #c(.75, .75))
p2
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1) +
theme(legend.position="top") #c(.75, .75))
p2
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') +
expand_limits(y=1) + theme(axis.text.x=element_blank(), legend.position="bottom"))
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + xlab('Degree of Skewness') + ylab('Acceptance Rate') +
expand_limits(y=1) + theme(axis.text.x=element_blank(), legend.position="bottom")
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') +
expand_limits(y=1) + theme(axis.text.x=element_blank(), legend.position="bottom")
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') +
expand_limits(y=1) + theme(axis.text.x=element_blank(), legend.position="bottom") +
scale_fill_manual(name="Degree of Skewness")
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') +
expand_limits(y=1) + theme(axis.text.x=element_blank(), legend.position="bottom") #+
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + expand_limits(y=1) +
theme(axis.text.x=element_blank(), legend.position="bottom") +
scale_fill_discrete(name="Degree of Skewness")
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + expand_limits(y=1) +
theme(axis.text.x=element_blank(), axis.title.x=element_blank(), legend.position="bottom") +
scale_fill_discrete(name="Degree of Skewness")
p1
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.position = 'none', axis.title.y = element_blank()) + expand_limits(y=1)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=1)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=1) +
theme(legend.position = 'none')
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.justification = c(1,0), legend.position=c(1,0), axis.title.y = element_blank()) +
expand_limits(y=1) +
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.justification = c(1,0), legend.position=c(1,0), axis.title.y = element_blank()) +
expand_limits(y=1) +
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.justification = c(1,0), legend.position=c(1,0), axis.title.y = element_blank()) +
expand_limits(y=1)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Degree of Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.justification = c(1,1), legend.position=c(1,1), axis.title.y = element_blank()) +
expand_limits(y=1)
p2
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
scale_fill_discrete(name = 'Skewness') + xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(legend.justification = c(1,1), legend.position=c(1,1), axis.title.y = element_blank()) +
expand_limits(y=1)
p2
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=1) +
theme(legend.position = 'none') + theme(axis.text.x=element_blank())
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.1,1) +
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
theme(legend.position = 'none') + theme(axis.text.x=element_blank())
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.1,1) +
)
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.1, 1)) +
theme(legend.position = 'none') + theme(axis.text.x=element_blank())
p1
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.05, 1)) +
theme(legend.position = 'none') + theme(axis.text.x=element_blank())
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.05, 1)) +
theme(legend.position = 'none') + theme(axis.text.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),)
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.05, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),)
p1
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
+ xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(axis.title.y = element_blank()) + expand_limits(y=1)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
xlab('Valence by Magnitude Interaction') +
theme_minimal() +theme(axis.title.y = element_blank()) + expand_limits(y=1)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate') + xlab('Degree of Skewness') + expand_limits(y=c(-.04, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate')  + expand_limits(y=c(-.04, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), axis.title.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),) #+ xlab('Degree of Skewness')
p1
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate')  + expand_limits(y=c(-.1, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), axis.title.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),) #+ xlab('Degree of Skewness')
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate')  + expand_limits(y=c(-.08, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), axis.title.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),) #+ xlab('Degree of Skewness')
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate')  + expand_limits(y=c(-.07, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), axis.title.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),) #+ xlab('Degree of Skewness')
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p1 <- ggplot(d2, aes(deg_skew, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
theme_minimal() + ylab('Acceptance Rate')  + expand_limits(y=c(-.06, 1)) +
theme(legend.position = 'none') + scale_fill_discrete(name = 'Skewness') +
theme(axis.text.x=element_blank(), axis.title.x=element_blank(), legend.justification = c(1,1), legend.position=c(1,1),) #+ xlab('Degree of Skewness')
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
p2 <- ggplot(d6, aes(magval, accept, fill = deg_skew)) + geom_bar(position=position_dodge(), stat='identity') +
geom_errorbar(aes(ymin=accept - se, ymax = accept + se), width = .2, position=position_dodge(.9)) +
xlab('Valence by Magnitude Interaction') +theme_minimal() + theme(axis.title.y = element_blank(), legend.position = 'none') +
expand_limits(y=1)
p3 <- multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
pdf('figs/deg_skew_plot1.pdf')
multiplot(p1, p2, layout = matrix(c(1,2,2,2), nrow=1, byrow=TRUE))
dev.off()
